# 📜 دستورالعمل کار با پروژه (Workflow Rules)

**تاریخ ایجاد:** 2025-10-18
**به‌روزرسانی:** همیشه

---

## 🎯 هدف این فایل:

این فایل **قوانین و دستورالعمل‌های کار** را مشخص می‌کند تا:
1. ✅ بعد از هر تغییر، Commit و Push انجام بشه
2. ✅ هر تغییر، راهنمای تست مهندسی داشته باشه
3. ✅ هر تغییر، راهنمای تست کاربری (ساده) داشته باشه
4. ✅ همه چیز مستند و قابل پیگیری باشه

---

# 📋 قانون طلایی: بعد از هر Task یا تغییر مهم

## گام ۱️⃣: انجام تغییرات
- کد بنویس
- فایل‌ها رو ویرایش کن
- مطمئن شو همه چیز کار می‌کنه

## گام ۲️⃣: آپدیت PROJECT_PROGRESS.md
```markdown
- [x] Subtask که انجام شد رو تیک بزن
- درصد پیشرفت task رو آپدیت کن
- یادداشت‌های مهم رو اضافه کن
- اگر task کامل شد، وضعیت رو به ✅ تغییر بده
```

## گام ۳️⃣: اضافه کردن راهنمای تست به TEST_CHECKLIST.md

### الف) راهنمای تست مهندسی (برای developer):
```markdown
## 🔧 تست مهندسی Task X.Y: [نام Task]

### چیزی که انجام شد:
- لیست تغییرات دقیق
- فایل‌هایی که تغییر کردند

### تست ۱: بررسی کد منبع
**مدت زمان:** X دقیقه

1. باز کن: فایل `path/to/file.ts`
2. چک کن: خطوط X تا Y
3. جستجو کن: برای pattern مشخص
4. نتیجه مورد انتظار:
   - ✅ باید ببینی: ...
   - ❌ نباید ببینی: ...

### تست ۲: بررسی Build
**مدت زمان:** X دقیقه

1. اجرا کن: `npm run build`
2. چک کن: خطایی نیست
3. نتیجه مورد انتظار:
   - ✅ Build موفق
   - ✅ هیچ error یا warning جدی نیست

### تست ۳: بررسی عملکرد
**مدت زمان:** X دقیقه

1. اجرا کن: `npm run dev`
2. باز کن: URL مشخص
3. تست کن: عملکرد خاص
4. نتیجه مورد انتظار:
   - ✅ کار می‌کنه بدون خطا
```

### ب) راهنمای تست کاربری (برای کاربر عادی):
```markdown
## 👤 تست کاربری Task X.Y: [نام Task به زبان ساده]

### چی عوض شد؟
- توضیح ساده به زبان غیرفنی
- چه چیزی باید فرق کنه از قبل

### تست ساده ۱: [نام تست]
**زمان:** X دقیقه

**مراحل:**
1. برو به صفحه X
2. کلیک کن روی دکمه Y
3. وارد کن: این اطلاعات
4. چک کن: آیا Z اتفاق افتاد؟

**نتیجه‌ای که باید ببینی:**
- ✅ صفحه باید به درستی لود بشه
- ✅ دکمه کار کنه
- ✅ پیغام موفقیت نمایش داده بشه
- ❌ خطایی نباید ببینی

**اگر مشکل دیدی:**
- اگر خطای X دیدی → احتمالاً Y مشکل داره
- اگر صفحه لود نشد → F12 رو بزن و console رو چک کن
- اگر دکمه کار نکرد → refresh کن و دوباره امتحان کن
```

## گام ۴️⃣: Commit تغییرات

### ساختار Commit Message:
```bash
git add .

git commit -m "$(cat <<'EOF'
<type>: <short description>

## Changes:
- تغییر ۱
- تغییر ۲
- تغییر ۳

## Testing:
✅ تست ۱ انجام شد
✅ تست ۲ انجام شد
✅ تست ۳ انجام شد

## Files Changed:
- path/to/file1.ts
- path/to/file2.tsx
- PROJECT_PROGRESS.md
- TEST_CHECKLIST.md

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"
```

### انواع Type:
- `feat:` - feature جدید
- `fix:` - رفع باگ
- `refactor:` - بازنویسی کد بدون تغییر عملکرد
- `docs:` - تغییرات مستندات
- `test:` - اضافه کردن یا تغییر تست‌ها
- `chore:` - تغییرات config یا build
- `style:` - تغییرات formatting

## گام ۵️⃣: Push به Remote (اختیاری)
```bash
# فقط وقتی آماده اشتراک‌گذاری باشیم
git push origin main
```

## گام ۶️⃣: پاسخ کامل به کاربر در چت (خیلی مهم!)

### ⚠️ مهم: این پاسخ باید شامل 3 بخش اصلی باشه:

### الف) خلاصه کار انجام شده:
```markdown
## ✅ Task X.Y کامل شد!

**خلاصه اقدامات:**
1. ✅ [تغییر ۱] انجام شد
2. ✅ [تغییر ۲] انجام شد
3. ✅ [تغییر ۳] انجام شد
4. ✅ تغییرات commit شد
5. ✅ تغییرات push شد به GitHub
6. ✅ TEST_CHECKLIST.md به‌روز شد و push شد

**فایل‌های تغییر یافته:**
- [file1.ts](path/to/file1.ts:10-20)
- [file2.tsx](path/to/file2.tsx:5-15)
- [PROJECT_PROGRESS.md](PROJECT_PROGRESS.md)
- [TEST_CHECKLIST.md](TEST_CHECKLIST.md)

**پیشرفت:**
- فاز ۱: X% → Y% (افزایش Z%)
- پیشرفت کلی: A% → B%
```

### ب) راهنمای تست کامل برای کاربر (نه فقط لینک!):
```markdown
## 🧪 حالا چطور تست کنی؟

### تست سریع (۲ دقیقه):

**گام ۱:**
برو به: http://localhost:5174/[صفحه]

**گام ۲:**
[توضیح ساده که چیکار کنه]

**گام ۳:**
چک کن: [چه چیزی باید ببینه]

**نتیجه مورد انتظار:**
✅ [چیزی که باید ببینه]
❌ [چیزی که نباید ببینه]

### اگر مشکل دیدی:

**مشکل ۱:** [توضیح مشکل]
- **راه حل:** [چیکار کنه]

**مشکل ۲:** [توضیح مشکل]
- **راه حل:** [چیکار کنه]

---

**تست کامل‌تر می‌خوای؟**
بیا به فایل [TEST_CHECKLIST.md](TEST_CHECKLIST.md) - بخش "Task X.Y"
```

### ج) آماده برای Task بعدی:
```markdown
## 🎯 Task بعدی چیه؟

طبق PROJECT_PROGRESS.md، Task بعدی:
- **Task X.Y:** [نام Task]
- **وضعیت:** [درصد]
- **اولویت:** [بالا/متوسط/پایین]
- **زمان تخمینی:** [X روز/ساعت]

می‌خوای الان شروع کنیم؟
یا می‌خوای اول این Task رو کامل تست کنی؟
```

---

# 📋 چک‌لیست کامل برای هر Task

قبل از commit، این چک‌لیست رو طی کن:

## ✅ قبل از Commit:

- [ ] **کد کار می‌کنه؟** (manual test کردی؟)
- [ ] **Build موفقه؟** (`npm run build` خطا نداد؟)
- [ ] **Console errors نیست؟** (F12 → Console چک کردی؟)
- [ ] **PROJECT_PROGRESS.md آپدیت شد؟** (تیک‌ها و درصدها)
- [ ] **TEST_CHECKLIST.md آپدیت شد؟** (راهنمای تست مهندسی + کاربری)
- [ ] **Commit message درسته؟** (type صحیح + توضیحات کامل)
- [ ] **Co-Authored-By اضافه شد؟**

## ✅ بعد از Commit:

- [ ] **Git log چک شد؟** (`git log -1` خوندی؟)
- [ ] **پاسخ در چت نوشته شد؟** (خلاصه + راهنمای تست + task بعدی)
- [ ] **منتظر تست کاربر؟** (قبل از task بعدی)

---

# 🎯 مثال کامل: اجرای یک Task از اول تا آخر

## مثال: Task 1.7 - Security & API Keys

### گام ۱: انجام تغییرات ✅
```typescript
// ایجاد .env
// تغییر supabaseClient.ts
// تغییر geminiService.ts
// تغییر .gitignore
```

### گام ۲: آپدیت PROJECT_PROGRESS.md ✅
```markdown
## Task 1.7: Security & API Keys
**وضعیت:** ✅ کامل (100%)

### Subtasks:
- [x] ایجاد .env و .env.example
- [x] انتقال API keys به environment variables
- [x] تست اپلیکیشن
...
```

### گام ۳: آپدیت TEST_CHECKLIST.md ✅

**بخش مهندسی:**
```markdown
## 🔧 تست مهندسی Task 1.7

### تست ۱: بررسی فایل .env
1. باز کن .env
2. چک کن 4 متغیر موجوده
...
```

**بخش کاربری:**
```markdown
## 👤 تست کاربری Task 1.7

### چی عوض شد؟
API keys دیگه توی کد نیستند، امن‌تر شده

### تست ساده:
1. برو login.html
2. سعی کن login کنی
3. باید کار کنه بدون خطا
...
```

### گام ۴: Commit ✅
```bash
git add .
git commit -m "feat: Complete Task 1.7 - Security & API Keys migration
...
Co-Authored-By: Claude <noreply@anthropic.com>"
```

### گام ۵: پاسخ در چت ✅
```markdown
## ✅ Task 1.7 کامل شد!

**خلاصه:**
1. ✅ .env ایجاد شد
2. ✅ API keys منتقل شدند
...

## 🧪 حالا چطور تست کنی؟
برو به login.html و سعی کن login کنی...

## 🎯 Task بعدی:
Task 1.8 - Refactor useStartupJourney
می‌خوای شروع کنیم؟
```

---

# 🚨 موارد مهم و یادآوری‌ها

## ❌ هرگز این کارها رو نکن:

1. ❌ **Commit بدون تست:** همیشه قبل از commit، manual test کن
2. ❌ **Commit بدون آپدیت PROJECT_PROGRESS.md:** همیشه آپدیت کن
3. ❌ **Commit بدون آپدیت TEST_CHECKLIST.md:** همیشه راهنمای تست بنویس
4. ❌ **Commit با message بد:** همیشه از format استاندارد استفاده کن
5. ❌ **شروع Task جدید بدون commit قبلی:** همیشه commit قبلی رو بزن
6. ❌ **Commit فایل .env:** همیشه .gitignore رو چک کن

## ✅ همیشه این کارها رو بکن:

1. ✅ **قبل از هر تغییر:** git status رو چک کن
2. ✅ **بعد از هر تغییر:** npm run build رو اجرا کن
3. ✅ **قبل از هر commit:** چک‌لیست بالا رو طی کن
4. ✅ **بعد از هر commit:** git log -1 رو ببین
5. ✅ **قبل از task جدید:** از کاربر بپرس تست کرده یا نه
6. ✅ **بعد از هر session:** PROJECT_PROGRESS.md رو آپدیت کن
7. ✅ **بعد از هر Task کامل:**
   - Commit و Push کد اصلی
   - به‌روزرسانی TEST_CHECKLIST.md
   - Commit و Push فایل TEST_CHECKLIST.md
   - نوشتن راهنمای تست کامل در چت (گام به گام، نه فقط لینک!)
   - اعلام به کاربر که کار تمومه

---

# 📊 Template‌های آماده

## Template 1: Commit Message
```bash
<type>: <short description>

## Changes:
- Change 1
- Change 2

## Testing:
✅ Test 1
✅ Test 2

## Files Changed:
- file1.ts
- file2.tsx

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
```

## Template 2: تست مهندسی در TEST_CHECKLIST.md
```markdown
## 🔧 تست مهندسی Task X.Y: [نام]

### تست ۱: [نام تست]
**مدت زمان:** X دقیقه

1. [مرحله 1]
2. [مرحله 2]
3. نتیجه مورد انتظار:
   - ✅ [نتیجه موفق]
   - ❌ [نتیجه ناموفق]
```

## Template 3: تست کاربری در TEST_CHECKLIST.md
```markdown
## 👤 تست کاربری Task X.Y: [نام ساده]

### چی عوض شد؟
[توضیح ساده]

### تست ساده:
**زمان:** X دقیقه

1. برو به [URL یا صفحه]
2. کلیک کن روی [دکمه]
3. چک کن: [چیزی که باید ببینه]

**نتیجه:**
✅ [موفق]
❌ [ناموفق]
```

## Template 4: پاسخ در چت
```markdown
## ✅ Task X.Y کامل شد!

**خلاصه اقدامات:**
1. ✅ [کار ۱]
2. ✅ [کار ۲]

**پیشرفت:**
- فاز ۱: X% → Y%

## 🧪 حالا چطور تست کنی؟

### تست سریع (X دقیقه):
1. [مرحله ۱]
2. [مرحله ۲]
3. نتیجه: [چی باید ببینه]

## 🎯 Task بعدی:
[نام task بعدی]
می‌خوای شروع کنیم؟
```

---

**آخرین به‌روزرسانی:** 2025-10-18
**نسخه:** 1.0
**وضعیت:** فعال و الزامی برای تمام Tasks
